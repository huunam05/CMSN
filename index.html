<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday V√µ Y·∫øn San</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- C·∫§U H√åNH CHUNG --- */
        :root {
            --primary-color: #ff9a9e;
            --secondary-color: #fecfef;
            --accent-color: #ff6b6b;
            --text-color: #555;
            --cake-color: #fad0c4;
            --icing-color: #fff5f7;
        }

        body {
            margin: 0; padding: 0;
            /* S·ª¨A L·ªñI CU·ªòN TRANG ·ªû ƒê√ÇY */
            min-height: 100vh; /* Chi·ªÅu cao t·ªëi thi·ªÉu b·∫±ng m√†n h√¨nh */
            display: flex; justify-content: center; align-items: center;
            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
            font-family: 'Nunito', sans-serif;
            
            /* Cho ph√©p cu·ªôn d·ªçc, ·∫©n cu·ªôn ngang */
            overflow-y: auto; 
            overflow-x: hidden;
            
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="%23ff6b6b"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>') 12 12, auto;
        }

        /* --- B·ª§I TI√äN & N·ªÄN (GHIM C·ªê ƒê·ªäNH background) --- */
        .fairy-dust { 
            position: fixed; /* ƒê·ªïi th√†nh fixed ƒë·ªÉ kh√¥ng b·ªã tr√¥i khi cu·ªôn */
            top: 0; left: 0; width: 100%; height: 100%; 
            overflow: hidden; z-index: -1; pointer-events: none; 
        }
        .dust-particle { position: absolute; background: white; border-radius: 50%; box-shadow: 0 0 10px white, 0 0 20px var(--secondary-color); animation: floatUp linear infinite; opacity: 0; }
        @keyframes floatUp { 0% { transform: translateY(100vh) scale(0); opacity: 0; } 20% { opacity: 0.8; } 100% { transform: translateY(-10vh) scale(1); opacity: 0; } }

        .background-circles { 
            position: fixed; /* ƒê·ªïi th√†nh fixed */
            top: 0; left: 0; width: 100%; height: 100%; 
            overflow: hidden; z-index: -2; 
        }
        .circle { position: absolute; border-radius: 50%; background: rgba(255, 255, 255, 0.3); animation: float 15s infinite linear; }
        .circle:nth-child(1) { width: 80px; height: 80px; left: 10%; top: 10%; animation-duration: 10s; }
        .circle:nth-child(2) { width: 120px; height: 120px; left: 80%; top: 20%; animation-duration: 14s; }
        .circle:nth-child(3) { width: 50px; height: 50px; left: 30%; top: 80%; animation-duration: 8s; }
        .circle:nth-child(4) { width: 100px; height: 100px; left: 70%; top: 70%; animation-duration: 12s; }
        @keyframes float { 0% { transform: translateY(0) rotate(0deg); opacity: 0.8; } 50% { transform: translateY(-20px) rotate(180deg); opacity: 0.5; } 100% { transform: translateY(0) rotate(360deg); opacity: 0.8; } }

        /* --- CARD CH√çNH --- */
        .card {
            background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-radius: 30px; padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15), inset 0 0 20px rgba(255,255,255,0.5);
            text-align: center; max-width: 450px; width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.6); position: relative;
            z-index: 10;
            
            /* Th√™m kho·∫£ng c√°ch ƒë·ªám ƒë·ªÉ khi cu·ªôn kh√¥ng b·ªã s√°t l·ªÅ */
            margin: 40px 0; 
            
            opacity: 0; animation: slideUp 1s forwards ease-out;
        }
        @keyframes slideUp { 
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; } 
        }

        /* --- ·∫¢NH TR√íN --- */
        .image-container {
            width: 220px; height: 220px; margin: 0 auto 15px; border-radius: 50%; overflow: hidden;
            border: 6px solid white; box-shadow: 0 15px 30px rgba(0,0,0,0.2); position: relative;
            animation: heartbeat 3s ease-in-out infinite;
        }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); box-shadow: 0 15px 30px rgba(0,0,0,0.2); } 50% { transform: scale(1.03); box-shadow: 0 20px 40px rgba(255, 154, 158, 0.4); } }
        .image-container:hover { animation: none; }
        .image-container:hover img { transform: scale(1.15) rotate(2deg); }
        .image-container img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease, opacity 0.3s ease; }

        .img-counter { font-size: 0.8rem; color: #888; margin-bottom: 10px; display: block; font-weight: bold; letter-spacing: 1px; }
        .slider-dots { margin-top: 5px; margin-bottom: 20px; display: flex; justify-content: center; gap: 6px; }
        .dot { height: 8px; width: 8px; background-color: rgba(255, 255, 255, 0.5); border-radius: 50%; cursor: pointer; transition: all 0.4s; border: 1px solid transparent; }
        .dot.active { background-color: var(--accent-color); transform: scale(1.4); border-color: white; box-shadow: 0 0 10px var(--accent-color); }

        /* --- CH·ªÆ & N√öT --- */
        h1 {
            font-family: 'Dancing Script', cursive; font-size: 3rem; margin: 0;
            background: linear-gradient(90deg, var(--accent-color), #fff, var(--accent-color)); background-size: 200% auto;
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: shimmer 3s linear infinite; text-shadow: 3px 3px 6px rgba(0,0,0,0.1);
        }
        @keyframes shimmer { to { background-position: 200% center; } }
        .name { font-size: 2.8rem; background: -webkit-linear-gradient(#ff6b6b, #ff9a9e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 15px; display: block; font-weight: bold; }
        .message { font-size: 1.15rem; color: var(--text-color); line-height: 1.7; margin-bottom: 30px; min-height: 60px; font-weight: 600; }
        
        .btn {
            background: linear-gradient(45deg, #ff9a9e, #fad0c4, #ff9a9e); background-size: 200% auto;
            border: none; padding: 14px 35px; border-radius: 50px; color: white; font-size: 1.2rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 10px 20px rgba(255, 154, 158, 0.4); transition: all 0.4s ease; outline: none; position: relative; overflow: hidden;
        }
        .btn:hover { background-position: right center; transform: translateY(-5px); box-shadow: 0 15px 30px rgba(255, 154, 158, 0.6); }
        .sparkle { position: absolute; width: 6px; height: 6px; border-radius: 50%; pointer-events: none; z-index: 9999; background-color: white; box-shadow: 0 0 10px 2px white; animation: sparkle-anim 1s forwards ease-out; }
        @keyframes sparkle-anim { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }

        /* ========================================= */
        /* --- CSS B√ÅNH KEM (ƒê√É FIX CU·ªòN) --- */
        /* ========================================= */

        .cake-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); z-index: 2000;
            opacity: 0; pointer-events: none; transition: opacity 0.5s ease;
            overflow-y: auto; /* QUAN TR·ªåNG: Cho ph√©p cu·ªôn d·ªçc */
        }
        .cake-overlay:not(.hidden) { opacity: 1; pointer-events: auto; }

        .cake-container-scroll {
            min-height: 100%; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
            padding: 40px 0;
        }

        .cake-wrapper { text-align: center; position: relative; }

        .cake-title {
            color: white; text-shadow: 0 0 10px rgba(255, 107, 107, 0.8); 
            font-family: 'Dancing Script', cursive; font-size: 2.8rem; margin-bottom: 50px;
        }
        
        .cake-box { position: relative; width: 300px; height: 300px; margin: 0 auto; }

        /* ƒêƒ©a v√† b√°nh */
        .plate { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 320px; height: 15px; background: #fff; border-radius: 10px; box-shadow: 0 5px 10px rgba(0,0,0,0.2); }
        .layer-1 { position: absolute; bottom: 35px; left: 50%; transform: translateX(-50%); width: 280px; height: 100px; background: var(--cake-color); border-radius: 15px 15px 5px 5px; box-shadow: inset -10px 0 15px rgba(0,0,0,0.05), 5px 5px 15px rgba(0,0,0,0.1); }
        .layer-2 { position: absolute; bottom: 135px; left: 50%; transform: translateX(-50%); width: 200px; height: 90px; background: var(--primary-color); border-radius: 15px 15px 5px 5px; box-shadow: inset -10px 0 15px rgba(0,0,0,0.05), 2px 5px 10px rgba(0,0,0,0.1); z-index: 5; }

        /* Kem ch·∫£y */
        .drip { position: absolute; top: 0; left: 0; width: 100%; height: 20px; background: var(--icing-color); border-radius: 15px 15px 0 0; }
        .drip::before, .drip::after { content: ''; position: absolute; background: var(--icing-color); border-radius: 50%; }
        .layer-1 .drip::before { top: 10px; left: 20px; width: 20px; height: 35px; }
        .layer-1 .drip::after { top: 10px; right: 40px; width: 25px; height: 45px; }
        .layer-2 .drip { background: #fff; }
        .layer-2 .drip::before { top: 10px; left: 10px; width: 15px; height: 30px; }
        .layer-2 .drip::after { top: 10px; right: 20px; width: 20px; height: 40px; }

        /* N·∫øn */
        .candle-container { position: absolute; bottom: 225px; left: 50%; transform: translateX(-50%); display: flex; gap: 25px; z-index: 10; }
        .candle-fancy { position: relative; width: 18px; height: 60px; background: repeating-linear-gradient(45deg, #fff, #fff 5px, #FF69B4 5px, #FF69B4 10px); border-radius: 3px; cursor: pointer; transition: transform 0.2s; box-shadow: 2px 2px 5px rgba(0,0,0,0.2); }
        .candle-fancy:hover { transform: scale(1.1); }
        .wick-fancy { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 3px; height: 10px; background: #333; }
        .flame-fancy { position: absolute; top: -30px; left: 50%; transform: translateX(-50%); width: 16px; height: 26px; background: radial-gradient(ellipse at bottom, #ffee00, #ff5e00); border-radius: 50% 50% 20% 20%; animation: flickerFancy 1s infinite alternate; box-shadow: 0 0 20px #ffaa00, 0 0 40px #ff5e00; }
        @keyframes flickerFancy { 0% { transform: translateX(-50%) scale(1) rotate(-2deg); opacity: 0.9; } 100% { transform: translateX(-50%) scale(0.95) rotate(2deg); opacity: 1; } }
        
        .candle-fancy.blown-out .flame-fancy { display: none; }
        .candle-fancy.blown-out .wick-fancy { opacity: 0.5; }

        .close-btn { margin-top: 30px; background: transparent; border: 2px solid white; }
        .close-btn:hover { background: rgba(255,255,255,0.2); }
        
        .wishes { margin-top: 20px; font-size: 1.5rem; color: #fff; font-weight: bold; opacity: 0; transition: opacity 1s; padding: 0 20px; line-height: 1.5; }
    </style>
</head>
<body>

    <div class="background-circles">
        <div class="circle"></div><div class="circle"></div><div class="circle"></div><div class="circle"></div>
    </div>
    <div class="fairy-dust" id="fairyDust"></div>

    <div class="card">
        <div class="image-container">
            <img src="ys1.png" id="mainImage" alt="V√µ Y·∫øn San">
        </div>
        <span class="img-counter" id="imgCounter">1 / 9</span>
        <div class="slider-dots" id="dotsContainer"></div>

        <h1>Happy Birthday</h1>
        <span class="name">V√µ Y·∫øn San</span>
        <p class="message" id="typingText"></p>

        <button class="btn" onclick="celebrate()">Nh·∫≠n Qu√† & Th·ªïi N·∫øn üéÅ</button>
        
        <audio id="bgMusic" loop autoplay>
            <source src="sinhnhat.mp3" type="audio/mpeg">
        </audio>
    </div>

    <div id="cakeOverlay" class="cake-overlay hidden">
        <div class="cake-container-scroll">
            <div class="cake-wrapper">
                <h2 class="cake-title">Nh·∫•n v√†o n·∫øn ƒë·ªÉ th·ªïi nha! üí®</h2>
                
                <div class="cake-box">
                    <div class="candle-container">
                        <div class="candle-fancy" onclick="blowCandle(this)"><div class="flame-fancy"></div><div class="wick-fancy"></div></div>
                        <div class="candle-fancy" onclick="blowCandle(this)"><div class="flame-fancy"></div><div class="wick-fancy"></div></div>
                        <div class="candle-fancy" onclick="blowCandle(this)"><div class="flame-fancy"></div><div class="wick-fancy"></div></div>
                    </div>
                    
                    <div class="layer-2"><div class="drip"></div></div>
                    <div class="layer-1"><div class="drip"></div></div>
                    <div class="plate"></div>
                </div>

                <div id="finalWishes" class="wishes">
                    üéâ Ch√∫c m·ª´ng sinh nh·∫≠t Y·∫øn San! <br>
                    Tu·ªïi m·ªõi th·∫≠t r·ª±c r·ª° nh√©! ‚ú®
                </div>

                <button class="btn close-btn" onclick="closeCake()">ƒê√≥ng l·∫°i</button>
            </div>
        </div>
    </div>

    <script>
        // --- C·∫§U H√åNH ---
        const images = ["ys1.png", "ys2.jpg", "ys3.jpg", "ys4.jpg", "ys5.png", "ys6.png", "ys7.png", "ys8.png", "ys9.png"];
        
        let currentImageIndex = 0;
        const mainImage = document.getElementById('mainImage');
        const imgCounter = document.getElementById('imgCounter');
        const dotsContainer = document.getElementById('dotsContainer');
        const cakeOverlay = document.getElementById('cakeOverlay');
        const music = document.getElementById('bgMusic');

        function attemptPlayMusic() {
            music.volume = 0.8;
            music.play().then(() => { console.log("Nh·∫°c ch·∫°y!"); }).catch(error => {
                document.addEventListener('click', function playOnFirstClick() {
                    music.play();
                    document.removeEventListener('click', playOnFirstClick);
                }, { once: true });
            });
        }

        const dustContainer = document.getElementById('fairyDust');
        for (let i = 0; i < 30; i++) {
            const particle = document.createElement('div');
            particle.classList.add('dust-particle');
            particle.style.left = Math.random() * 100 + '%';
            particle.style.width = particle.style.height = Math.random() * 4 + 2 + 'px';
            particle.style.animationDuration = Math.random() * 10 + 10 + 's';
            particle.style.animationDelay = Math.random() * 5 + 's';
            dustContainer.appendChild(particle);
        }

        document.addEventListener('mousemove', function(e) {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle');
            sparkle.style.left = e.pageX + 'px';
            sparkle.style.top = e.pageY + 'px';
            const colors = ['#ff9a9e', '#fecfef', '#a18cd1', '#fff', '#ffd700'];
            sparkle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            document.body.appendChild(sparkle);
            setTimeout(() => { sparkle.remove(); }, 1000);
        });

        images.forEach((_, index) => {
            const dot = document.createElement('span');
            dot.classList.add('dot');
            if (index === 0) dot.classList.add('active');
            dot.onclick = () => changeImage(index);
            dotsContainer.appendChild(dot);
        });
        const dots = document.querySelectorAll('.dot');

        function changeImage(index) {
            currentImageIndex = index;
            mainImage.style.opacity = 0; mainImage.style.transform = "scale(0.95)";
            setTimeout(() => {
                mainImage.src = images[currentImageIndex];
                mainImage.style.opacity = 1; mainImage.style.transform = "scale(1)";
                imgCounter.textContent = (currentImageIndex + 1) + " / " + images.length;
            }, 300);
            dots.forEach(dot => dot.classList.remove('active'));
            dots[index].classList.add('active');
        }
        setInterval(() => { currentImageIndex = (currentImageIndex + 1) % images.length; changeImage(currentImageIndex); }, 3500);

        const text = "Ch√∫c Y·∫øn San tu·ªïi m·ªõi r·ª±c r·ª° v√† xinh ƒë·∫πp! Mong m·ªçi ƒëi·ªÅu may m·∫Øn nh·∫•t s·∫Ω ƒë·∫øn v·ªõi c·∫≠u. Happy Birthday! üéÇ‚ú®";
        const typingElement = document.getElementById('typingText');
        let i = 0;
        function typeWriter() {
            if (i < text.length) { typingElement.innerHTML += text.charAt(i); i++; setTimeout(typeWriter, 50); }
        }

        window.onload = () => {
            typeWriter();
            shootConfettiSmall();
            mainImage.src = images[0];
            attemptPlayMusic();
        };

        function shootConfettiSmall() {
            const duration = 3000; const end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#ff9a9e', '#fad0c4', '#fbc2eb'] });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ff9a9e', '#fad0c4', '#fbc2eb'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }
        function shootConfettiBig() {
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 2002 };
            confetti(Object.assign({}, defaults, { particleCount: 100, origin: { x: 0.5, y: 0.5 }, colors: ['#ff6b6b', '#fbc2eb', '#ffd1ff', '#fff', '#ffd700'] }));
        }

        function celebrate() {
            music.play().catch(() => {});
            cakeOverlay.classList.remove('hidden');
            document.querySelector('.card .btn').textContent = "Y√™u T·∫•n nh√©! ‚ù§Ô∏è";
        }

        let candlesBlown = 0;
        function blowCandle(candleElement) {
            if (!candleElement.classList.contains('blown-out')) {
                candleElement.classList.add('blown-out');
                candlesBlown++;
                if (navigator.vibrate) navigator.vibrate(100);
                
                if (candlesBlown === 3) {
                    setTimeout(() => {
                        shootConfettiBig();
                        document.querySelector('.cake-title').textContent = "Happy Birthday!";
                        document.getElementById('finalWishes').style.opacity = 1;
                        setTimeout(closeCake, 5000); 
                    }, 500);
                }
            }
        }
        function closeCake() {
            cakeOverlay.classList.add('hidden');
            setTimeout(() => {
                 document.querySelectorAll('.candle-fancy').forEach(c => c.classList.remove('blown-out'));
                 candlesBlown = 0;
                 document.querySelector('.cake-title').textContent = "Nh·∫•n v√†o n·∫øn ƒë·ªÉ th·ªïi nha! üí®";
                 document.getElementById('finalWishes').style.opacity = 0;
            }, 500);
        }
    </script>
</body>
</html>